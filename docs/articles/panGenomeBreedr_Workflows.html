<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>panGenomeBreedr_Workflows • panGenomeBreedr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="panGenomeBreedr_Workflows">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">panGenomeBreedr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/awkena/panGenomeBreedr" aria-label="GitHub repository"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>panGenomeBreedr_Workflows</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/awkena/panGenomeBreedr/blob/HEAD/vignettes/panGenomeBreedr_Workflows.Rmd" class="external-link"><code>vignettes/panGenomeBreedr_Workflows.Rmd</code></a></small>
      <div class="d-none name"><code>panGenomeBreedr_Workflows.Rmd</code></div>
    </div>

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<!-- badges: start -->
<!-- badges: end -->
<div class="section level2">
<h2 id="table-of-contents">Table of contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h2>
<ul>
<li>
<a href="#variant-discovery">Variant Discovery</a>
<ul>
<li><a href="#pangenome-data-and-database-rationale">Pangenome Data and
Database Rationale</a></li>
<li><a href="#recommended-schema-for-the-sqlite-database">Recommended
Schema for the SQLite Database</a></li>
<li><a href="#database-creation">Database Creation</a></li>
<li><a href="#query-variant-tables">Query Variant Tables</a></li>
<li><a href="#filter-variants-by-allele-frequency">Filter Variants by
Allele Frequency</a></li>
<li><a href="#summarize-snpeff-annotation-and-impact">Summarize SnpEff
Annotation and Impact</a></li>
</ul>
</li>
<li><a href="#kasp-marker-design">KASP Marker Design</a></li>
<li><a href="#kasp-marker-validation">KASP Marker Validation</a></li>
<li>
<a href="#decision-support-for-trait-introgression-and-mabc">Decision
Support for Trait Introgression and MABC</a>
<ul>
<li><a href="#creating-heatmaps-with-pangb">Creating Heatmaps with
<code>panGB</code></a></li>
<li><a href="#trait-introgression-hypothesis-testing">Trait
Introgression Hypothesis Testing</a></li>
<li><a href="#decision-support-for-mabc">Decision Support for
MABC</a></li>
<li><a href="#weighted-rpp-computation-in-pangb">Weighted RPP
computation in panGB</a></li>
<li><a href="#decision-support-for-foreground-selection">Decision
Support for Foreground Selection</a></li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="variant-discovery">Variant Discovery<a class="anchor" aria-label="anchor" href="#variant-discovery"></a>
</h2>
<div class="section level3">
<h3 id="pangenome-data-and-database-rationale">Pangenome Data and Database Rationale<a class="anchor" aria-label="anchor" href="#pangenome-data-and-database-rationale"></a>
</h3>
<p>The examples used in this documentation are based on <strong>sorghum
pangenome resources</strong> derived from whole-genome resequencing data
of <strong>1,676 sorghum lines</strong>. Variant calling was performed
using version <strong>v5.1</strong> of the <strong>BTx623</strong>
reference genome. The resulting <strong>SNP</strong> and
<strong>INDEL</strong> variants were functionally annotated using
<strong>snpEff</strong>.</p>
<p>Direct querying of <strong>snpEff-annotated VCF files</strong> from R
is often computationally slow and inefficient, especially with large
datasets. To overcome this limitation, we built a <strong>SQLite
database</strong> that stores the variants, annotations, and genotypes
in normalized tables. This structure allows for <strong>fast and
flexible access</strong> to relevant data, supporting workflows for
trait-predictive marker discovery.</p>
<p><strong>We strongly recommend the creation of similar databases for
other crops</strong>. The SQLite format offers a compact, portable, and
queryable representation of pangenome-derived variant data,
significantly improving performance and reproducibility in variant
discovery pipelines.</p>
<p><strong>A compressed format of the SQLite database for sorghum can be
downloaded</strong> <a href="https://drive.google.com/file/d/1L4S7_ZGeFyu_bA7rRsmTpf9V8__VLB-R/view?usp=sharing" class="external-link">here</a>.</p>
</div>
<div class="section level3">
<h3 id="recommended-schema-for-the-sqlite-database">Recommended Schema for the SQLite Database<a class="anchor" aria-label="anchor" href="#recommended-schema-for-the-sqlite-database"></a>
</h3>
<p>The SQLite database contains the following three key tables:</p>
<div class="section level4">
<h4 id="variants">
<code>variants</code><a class="anchor" aria-label="anchor" href="#variants"></a>
</h4>
<p>This table stores core metadata variant information extracted from
the VCF.</p>
<table class="table">
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>variant_id</code></td>
<td>Unique variant identifier</td>
</tr>
<tr class="even">
<td><code>chrom</code></td>
<td>Chromosome name</td>
</tr>
<tr class="odd">
<td><code>pos</code></td>
<td>Genomic position (1-based)</td>
</tr>
<tr class="even">
<td><code>ref</code></td>
<td>Reference allele</td>
</tr>
<tr class="odd">
<td><code>alt</code></td>
<td>Alternate allele</td>
</tr>
<tr class="even">
<td><code>variant_type</code></td>
<td>Type of variant (e.g., SNP, indel)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="annotations">
<code>annotations</code><a class="anchor" aria-label="anchor" href="#annotations"></a>
</h4>
<p>This table contains functional annotations from
<strong>snpEff</strong>, typically including predicted effects, gene
names, and functional categories.</p>
<table class="table">
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>variant_id</code></td>
<td>Foreign key linking to <code>variants</code>
</td>
</tr>
<tr class="even">
<td><code>gene_name</code></td>
<td>Sorghum gene ID (e.g., “Sobic.005G213600”)</td>
</tr>
<tr class="odd">
<td><code>effect</code></td>
<td>Type of effect (e.g., missense_variant)</td>
</tr>
<tr class="even">
<td><code>impact</code></td>
<td>snpEff predicted impact (e.g., HIGH)</td>
</tr>
<tr class="odd">
<td><code>feature_type</code></td>
<td>Type of annotated feature (e.g., exon)</td>
</tr>
<tr class="even">
<td>…</td>
<td>Additional snpEff annotation fields</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="genotypes">
<code>genotypes</code><a class="anchor" aria-label="anchor" href="#genotypes"></a>
</h4>
<p>This table stores genotype calls per sample for each variant in a
wide format.</p>
<table class="table">
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>variant_id</code></td>
<td>Foreign key linking to <code>variants</code>
</td>
</tr>
<tr class="even">
<td><code>chrom</code></td>
<td>Chromosome name</td>
</tr>
<tr class="odd">
<td><code>pos</code></td>
<td>Genomic position</td>
</tr>
<tr class="even">
<td><code>sample1</code></td>
<td>Genotype for Sample 1 (e.g., <code>1|1</code>)</td>
</tr>
<tr class="odd">
<td><code>sample2</code></td>
<td>Genotype for Sample 2 (e.g., <code>0|0</code>)</td>
</tr>
<tr class="even">
<td>…</td>
<td>Genotypes for other samples</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="database-creation">Database Creation<a class="anchor" aria-label="anchor" href="#database-creation"></a>
</h3>
<p>We generated the SQLite database using a custom workflow that</p>
<ol style="list-style-type: decimal">
<li>Parses a multi-sample VCF file annotated by snpEff,</li>
<li>Extracts variant, annotation, and genotype data,</li>
<li>Writes the data into normalized relational tables
(<code>variants</code>, <code>annotations</code>,
<code>genotypes</code>).</li>
</ol>
<p>A prebuilt mini example database
(<code>mini_sorghum_variant_vcf.db.gz</code>) is included in the
<code>extdata/</code> folder of the package.</p>
</div>
<div class="section level3">
<h3 id="query-variant-tables">Query Variant Tables<a class="anchor" aria-label="anchor" href="#query-variant-tables"></a>
</h3>
<p>The <code><a href="../reference/query_db.html">query_db()</a></code> function allows users to query specific
tables within a panGenomeBreedr-formatted SQLite database for variants,
annotations, or genotypes based on chromosome coordinates or candidate
gene IDs.</p>
<p>This function retrieves records from one of the following tables in
the database:</p>
<ul>
<li>
<code>variants</code>: Basic variant information (chromosome,
position, REF/ALT alleles, etc.)</li>
<li>
<code>annotations</code>: Variant effect predictions (e.g., from
snpEff)</li>
<li>
<code>genotypes</code>: Genotypic data across lines/samples plus the
metadata of the variants.</li>
</ul>
<p>Users can specify genomic coordinates (<code>chrom</code>,
<code>start</code>, <code>end</code>) or a candidate gene name
(<code>gene_name</code>) to extract relevant entries.</p>
<p>If used correctly, the <code><a href="../reference/query_db.html">query_db()</a></code> function returns a
data frame containing the filtered records from the selected table.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This example uses the mini SQLite database included in the package.</span></span>
<span><span class="co"># Define a temporary path and decompress the example database</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mini_db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"mini_sorghum_variant_vcf.db.gz"</span>,</span>
<span>                       package <span class="op">=</span> <span class="st">"panGenomeBreedr"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mini_db_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path</span>, <span class="st">'mini_sorghum_variant_vcf.db'</span><span class="op">)</span></span>
<span><span class="fu">R.utils</span><span class="fu">::</span><span class="fu"><a href="https://henrikbengtsson.github.io/R.utils/reference/compressFile.html" class="external-link">gunzip</a></span><span class="op">(</span><span class="va">mini_db</span>, destname <span class="op">=</span> <span class="va">mini_db_path</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Query VCF genotypes within the genomic range: Chr05:75104537-75106403</span></span>
<span><span class="va">gt_region</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/query_db.html">query_db</a></span><span class="op">(</span>db_path <span class="op">=</span> <span class="va">mini_db_path</span>,</span>
<span>                      chrom <span class="op">=</span> <span class="st">"Chr05"</span>,</span>
<span>                      start <span class="op">=</span> <span class="fl">75104537</span>,</span>
<span>                      end <span class="op">=</span> <span class="fl">75106403</span>,</span>
<span>                      table_name <span class="op">=</span> <span class="st">"genotypes"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Query snpEff annotations within a candidate gene</span></span>
<span><span class="va">annota_region</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/query_db.html">query_db</a></span><span class="op">(</span>db_path <span class="op">=</span> <span class="va">mini_db_path</span>,</span>
<span>                          chrom <span class="op">=</span> <span class="st">"Chr05"</span>,</span>
<span>                          start <span class="op">=</span> <span class="fl">75104537</span>,</span>
<span>                          end <span class="op">=</span> <span class="fl">75106403</span>,</span>
<span>                          table_name <span class="op">=</span> <span class="st">"annotations"</span>,</span>
<span>                          gene_name <span class="op">=</span> <span class="st">"Sobic.005G213600"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clean up temporary files</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>       recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
Table 1: Queried genotypes for varaints from the SQLite database.
</caption>
<thead><tr>
<th style="text-align:left;">
variant_id
</th>
<th style="text-align:left;">
chrom
</th>
<th style="text-align:left;">
pos
</th>
<th style="text-align:left;">
variant_type
</th>
<th style="text-align:left;">
ref
</th>
<th style="text-align:left;">
alt
</th>
<th style="text-align:left;">
IDMM
</th>
<th style="text-align:left;">
ISGC
</th>
<th style="text-align:left;">
ISGK
</th>
<th style="text-align:left;">
ISHC
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
INDEL_Chr05_75104541
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:left;">
75104541
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
TGAC
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
</tr>
<tr>
<td style="text-align:left;">
SNP_Chr05_75104557
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:left;">
75104557
</td>
<td style="text-align:left;">
SNP
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
</tr>
<tr>
<td style="text-align:left;">
SNP_Chr05_75104560
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:left;">
75104560
</td>
<td style="text-align:left;">
SNP
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
</tr>
<tr>
<td style="text-align:left;">
INDEL_Chr05_75104564
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:left;">
75104564
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
CA
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
</tr>
<tr>
<td style="text-align:left;">
SNP_Chr05_75104568
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:left;">
75104568
</td>
<td style="text-align:left;">
SNP
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>
Table 2: Queried annotations for variants from the SQLite database.
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
variant_id
</th>
<th style="text-align:left;">
allele
</th>
<th style="text-align:left;">
annotation
</th>
<th style="text-align:left;">
impact
</th>
<th style="text-align:left;">
gene_name
</th>
<th style="text-align:left;">
gene_id
</th>
<th style="text-align:left;">
feature_type
</th>
<th style="text-align:left;">
feature_id
</th>
<th style="text-align:left;">
transcript_biotype
</th>
<th style="text-align:left;">
rank
</th>
<th style="text-align:left;">
HGVS_c
</th>
<th style="text-align:left;">
HGVS_p
</th>
<th style="text-align:left;">
chrom
</th>
<th style="text-align:right;">
pos
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
INDEL_Chr05_75104541
</td>
<td style="text-align:left;">
TGAC
</td>
<td style="text-align:left;">
3_prime_UTR_variant
</td>
<td style="text-align:left;">
MODIFIER
</td>
<td style="text-align:left;">
Sobic.005G213600
</td>
<td style="text-align:left;">
Sobic.005G213600.v5.1
</td>
<td style="text-align:left;">
transcript
</td>
<td style="text-align:left;">
Sobic.005G213600.1.v5.1
</td>
<td style="text-align:left;">
protein_coding
</td>
<td style="text-align:left;">
2/2
</td>
<td style="text-align:left;">
c.<em>322_</em>324dupGTC
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75104541
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
SNP_Chr05_75104557
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
3_prime_UTR_variant
</td>
<td style="text-align:left;">
MODIFIER
</td>
<td style="text-align:left;">
Sobic.005G213600
</td>
<td style="text-align:left;">
Sobic.005G213600.v5.1
</td>
<td style="text-align:left;">
transcript
</td>
<td style="text-align:left;">
Sobic.005G213600.1.v5.1
</td>
<td style="text-align:left;">
protein_coding
</td>
<td style="text-align:left;">
2/2
</td>
<td style="text-align:left;">
c.*309G&gt;A
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75104557
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
SNP_Chr05_75104560
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
3_prime_UTR_variant
</td>
<td style="text-align:left;">
MODIFIER
</td>
<td style="text-align:left;">
Sobic.005G213600
</td>
<td style="text-align:left;">
Sobic.005G213600.v5.1
</td>
<td style="text-align:left;">
transcript
</td>
<td style="text-align:left;">
Sobic.005G213600.1.v5.1
</td>
<td style="text-align:left;">
protein_coding
</td>
<td style="text-align:left;">
2/2
</td>
<td style="text-align:left;">
c.*306G&gt;A
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75104560
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
INDEL_Chr05_75104564
</td>
<td style="text-align:left;">
CA
</td>
<td style="text-align:left;">
3_prime_UTR_variant
</td>
<td style="text-align:left;">
MODIFIER
</td>
<td style="text-align:left;">
Sobic.005G213600
</td>
<td style="text-align:left;">
Sobic.005G213600.v5.1
</td>
<td style="text-align:left;">
transcript
</td>
<td style="text-align:left;">
Sobic.005G213600.1.v5.1
</td>
<td style="text-align:left;">
protein_coding
</td>
<td style="text-align:left;">
2/2
</td>
<td style="text-align:left;">
c.*301dupT
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75104564
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
SNP_Chr05_75104568
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
3_prime_UTR_variant
</td>
<td style="text-align:left;">
MODIFIER
</td>
<td style="text-align:left;">
Sobic.005G213600
</td>
<td style="text-align:left;">
Sobic.005G213600.v5.1
</td>
<td style="text-align:left;">
transcript
</td>
<td style="text-align:left;">
Sobic.005G213600.1.v5.1
</td>
<td style="text-align:left;">
protein_coding
</td>
<td style="text-align:left;">
2/2
</td>
<td style="text-align:left;">
c.*298C&gt;A
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75104568
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="summarize-snpeff-annotation-and-impact">Summarize SnpEff Annotation and Impact<a class="anchor" aria-label="anchor" href="#summarize-snpeff-annotation-and-impact"></a>
</h3>
<p>The <code><a href="../reference/query_ann_summary.html">query_ann_summary()</a></code> function provides a convenient
way to summarize the distribution of <strong>SnpEff annotations</strong>
and <strong>impact categories</strong> across variant types (e.g., SNPs,
indels) within a defined genomic region.</p>
<p>This function enables users to quickly assess the types and
functional implications of variants located within candidate genes or
genomic intervals of interest.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepare test database</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mini_db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"mini_sorghum_variant_vcf.db.gz"</span>,</span>
<span>                       package <span class="op">=</span> <span class="st">"panGenomeBreedr"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mini_db_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path</span>, <span class="st">'mini_sorghum_variant_vcf.db'</span><span class="op">)</span></span>
<span><span class="fu">R.utils</span><span class="fu">::</span><span class="fu"><a href="https://henrikbengtsson.github.io/R.utils/reference/compressFile.html" class="external-link">gunzip</a></span><span class="op">(</span><span class="va">mini_db</span>, destname <span class="op">=</span> <span class="va">mini_db_path</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run annotation summary for region Chr05:75104537-75106403</span></span>
<span><span class="va">ann_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/query_ann_summary.html">query_ann_summary</a></span><span class="op">(</span>db_path <span class="op">=</span> <span class="va">mini_db_path</span>,</span>
<span>                                 chrom <span class="op">=</span> <span class="st">"Chr05"</span>,</span>
<span>                                 start <span class="op">=</span> <span class="fl">75104537</span>,</span>
<span>                                 end <span class="op">=</span> <span class="fl">75106403</span><span class="op">)</span></span>
<span><span class="co"># Clean up</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>       recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
Annotation summary for variants within the genomic range.
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
annotation
</th>
<th style="text-align:left;">
variant_type
</th>
<th style="text-align:right;">
count
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
upstream_gene_variant
</td>
<td style="text-align:left;">
SNP
</td>
<td style="text-align:right;">
149
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
upstream_gene_variant
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:right;">
53
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
downstream_gene_variant
</td>
<td style="text-align:left;">
SNP
</td>
<td style="text-align:right;">
46
</td>
</tr>
<tr>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
missense_variant
</td>
<td style="text-align:left;">
SNP
</td>
<td style="text-align:right;">
29
</td>
</tr>
<tr>
<td style="text-align:left;">
23
</td>
<td style="text-align:left;">
synonymous_variant
</td>
<td style="text-align:left;">
SNP
</td>
<td style="text-align:right;">
21
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
3_prime_UTR_variant
</td>
<td style="text-align:left;">
SNP
</td>
<td style="text-align:right;">
18
</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>
Functional impact summary for variants within the genomic range.
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
impact
</th>
<th style="text-align:left;">
variant_type
</th>
<th style="text-align:right;">
count
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
MODIFIER
</td>
<td style="text-align:left;">
SNP
</td>
<td style="text-align:right;">
220
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
MODIFIER
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:right;">
82
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
MODERATE
</td>
<td style="text-align:left;">
SNP
</td>
<td style="text-align:right;">
29
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
LOW
</td>
<td style="text-align:left;">
SNP
</td>
<td style="text-align:right;">
21
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
HIGH
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
MODERATE
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
<p>The <code><a href="../reference/query_ann_summary.html">query_ann_summary()</a></code> function returns a
<code>list</code> with the following elements:</p>
<ul>
<li><p><code>annotation_summary</code>: Data frame summarizing the count
of each SnpEff annotation grouped by variant type.</p></li>
<li><p><code>impact_summary</code>: Data frame summarizing the count of
each SnpEff impact level (e.g., HIGH, MODERATE) grouped by variant
type.</p></li>
<li><p><code>variant_type_totals</code>: Total count of variants in the
region grouped by variant type.</p></li>
</ul>
<p><strong>The annotation summary shows that there are six (6) INDEL
variants with a HIGH impact on protein function.</strong> To see these
variants, we need to use the <code><a href="../reference/query_by_impact.html">query_by_impact()</a></code> function, as
shown below:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Prepare test database</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mini_db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"mini_sorghum_variant_vcf.db.gz"</span>,</span>
<span>                       package <span class="op">=</span> <span class="st">"panGenomeBreedr"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mini_db_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path</span>, <span class="st">'mini_sorghum_variant_vcf.db'</span><span class="op">)</span></span>
<span><span class="fu">R.utils</span><span class="fu">::</span><span class="fu"><a href="https://henrikbengtsson.github.io/R.utils/reference/compressFile.html" class="external-link">gunzip</a></span><span class="op">(</span><span class="va">mini_db</span>, destname <span class="op">=</span> <span class="va">mini_db_path</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract HIGH impact variant for a region or gene</span></span>
<span><span class="va">high_variants</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/query_by_impact.html">query_by_impact</a></span><span class="op">(</span>db_path <span class="op">=</span> <span class="va">mini_db_path</span>,</span>
<span>                                impact_level <span class="op">=</span> <span class="st">'high'</span>,</span>
<span>                                chrom <span class="op">=</span> <span class="st">"Chr05"</span>,</span>
<span>                                start <span class="op">=</span> <span class="fl">75104537</span>,</span>
<span>                                end <span class="op">=</span> <span class="fl">75106403</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clean up</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>       recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
HIGH impact variants within a defined genomic range.
</caption>
<thead><tr>
<th style="text-align:left;">
variant_id
</th>
<th style="text-align:left;">
chrom
</th>
<th style="text-align:right;">
pos
</th>
<th style="text-align:left;">
ref
</th>
<th style="text-align:left;">
alt
</th>
<th style="text-align:left;">
qual
</th>
<th style="text-align:left;">
filter
</th>
<th style="text-align:left;">
variant_type
</th>
<th style="text-align:left;">
allele
</th>
<th style="text-align:left;">
annotation
</th>
<th style="text-align:left;">
impact
</th>
<th style="text-align:left;">
gene_name
</th>
<th style="text-align:left;">
gene_id
</th>
<th style="text-align:left;">
feature_type
</th>
<th style="text-align:left;">
feature_id
</th>
<th style="text-align:left;">
transcript_biotype
</th>
<th style="text-align:left;">
rank
</th>
<th style="text-align:left;">
HGVS_c
</th>
<th style="text-align:left;">
HGVS_p
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
INDEL_Chr05_75104881
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75104881
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
GTCGA
</td>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
PASS
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:left;">
GTCGA
</td>
<td style="text-align:left;">
frameshift_variant
</td>
<td style="text-align:left;">
HIGH
</td>
<td style="text-align:left;">
Sobic.005G213600
</td>
<td style="text-align:left;">
Sobic.005G213600.v5.1
</td>
<td style="text-align:left;">
transcript
</td>
<td style="text-align:left;">
Sobic.005G213600.1.v5.1
</td>
<td style="text-align:left;">
protein_coding
</td>
<td style="text-align:left;">
2/2
</td>
<td style="text-align:left;">
c.1343_1344insTCGA
</td>
<td style="text-align:left;">
p.Ser449fs
</td>
</tr>
<tr>
<td style="text-align:left;">
INDEL_Chr05_75105587
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75105587
</td>
<td style="text-align:left;">
GC
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
PASS
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
frameshift_variant
</td>
<td style="text-align:left;">
HIGH
</td>
<td style="text-align:left;">
Sobic.005G213600
</td>
<td style="text-align:left;">
Sobic.005G213600.v5.1
</td>
<td style="text-align:left;">
transcript
</td>
<td style="text-align:left;">
Sobic.005G213600.1.v5.1
</td>
<td style="text-align:left;">
protein_coding
</td>
<td style="text-align:left;">
2/2
</td>
<td style="text-align:left;">
c.637delG
</td>
<td style="text-align:left;">
p.Ala213fs
</td>
</tr>
<tr>
<td style="text-align:left;">
INDEL_Chr05_75105598
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75105598
</td>
<td style="text-align:left;">
GT
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
PASS
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
frameshift_variant
</td>
<td style="text-align:left;">
HIGH
</td>
<td style="text-align:left;">
Sobic.005G213600
</td>
<td style="text-align:left;">
Sobic.005G213600.v5.1
</td>
<td style="text-align:left;">
transcript
</td>
<td style="text-align:left;">
Sobic.005G213600.1.v5.1
</td>
<td style="text-align:left;">
protein_coding
</td>
<td style="text-align:left;">
2/2
</td>
<td style="text-align:left;">
c.626delA
</td>
<td style="text-align:left;">
p.Asp209fs
</td>
</tr>
<tr>
<td style="text-align:left;">
INDEL_Chr05_75106156
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75106156
</td>
<td style="text-align:left;">
CGTAT
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
PASS
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
frameshift_variant
</td>
<td style="text-align:left;">
HIGH
</td>
<td style="text-align:left;">
Sobic.005G213600
</td>
<td style="text-align:left;">
Sobic.005G213600.v5.1
</td>
<td style="text-align:left;">
transcript
</td>
<td style="text-align:left;">
Sobic.005G213600.1.v5.1
</td>
<td style="text-align:left;">
protein_coding
</td>
<td style="text-align:left;">
2/2
</td>
<td style="text-align:left;">
c.65_68delATAC
</td>
<td style="text-align:left;">
p.His22fs
</td>
</tr>
<tr>
<td style="text-align:left;">
INDEL_Chr05_75106295
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75106295
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
ATC
</td>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
PASS
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:left;">
ATC
</td>
<td style="text-align:left;">
frameshift_variant
</td>
<td style="text-align:left;">
HIGH
</td>
<td style="text-align:left;">
Sobic.005G213600
</td>
<td style="text-align:left;">
Sobic.005G213600.v5.1
</td>
<td style="text-align:left;">
transcript
</td>
<td style="text-align:left;">
Sobic.005G213600.1.v5.1
</td>
<td style="text-align:left;">
protein_coding
</td>
<td style="text-align:left;">
1/2
</td>
<td style="text-align:left;">
c.38_39dupGA
</td>
<td style="text-align:left;">
p.Ser14fs
</td>
</tr>
<tr>
<td style="text-align:left;">
INDEL_Chr05_75106325
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75106325
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
GTA
</td>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
PASS
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:left;">
GTA
</td>
<td style="text-align:left;">
frameshift_variant
</td>
<td style="text-align:left;">
HIGH
</td>
<td style="text-align:left;">
Sobic.005G213600
</td>
<td style="text-align:left;">
Sobic.005G213600.v5.1
</td>
<td style="text-align:left;">
transcript
</td>
<td style="text-align:left;">
Sobic.005G213600.1.v5.1
</td>
<td style="text-align:left;">
protein_coding
</td>
<td style="text-align:left;">
1/2
</td>
<td style="text-align:left;">
c.8_9dupTA
</td>
<td style="text-align:left;">
p.Gln4fs
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="filter-variants-by-allele-frequency">Filter Variants by Allele Frequency<a class="anchor" aria-label="anchor" href="#filter-variants-by-allele-frequency"></a>
</h3>
<p>The <code><a href="../reference/query_by_af.html">query_by_af()</a></code> and <code><a href="../reference/filter_by_af.html">filter_by_af()</a></code>
functions allow users to filter queried variants based on
<strong>alternate allele frequency thresholds</strong> within a
specified genomic region.</p>
<p>This is particularly useful for identifying <strong>polymorphic
sites</strong> within candidate gene regions or windows of interest that
meet desired minor allele frequency (MAF) thresholds for marker
development.</p>
<p>An example usage for the <code><a href="../reference/filter_by_af.html">filter_by_af()</a></code> function is
shown in the code snippet below:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define temporary directory and decompress demo database</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mini_db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"mini_sorghum_variant_vcf.db.gz"</span>,</span>
<span>                       package <span class="op">=</span> <span class="st">"panGenomeBreedr"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mini_db_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path</span>, <span class="st">'mini_sorghum_variant_vcf.db'</span><span class="op">)</span></span>
<span><span class="fu">R.utils</span><span class="fu">::</span><span class="fu"><a href="https://henrikbengtsson.github.io/R.utils/reference/compressFile.html" class="external-link">gunzip</a></span><span class="op">(</span><span class="va">mini_db</span>, destname <span class="op">=</span> <span class="va">mini_db_path</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract genotype data for all HIGH impact variants and filter by alternate allele frequency</span></span>
<span><span class="va">geno_high_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/query_genotypes.html">query_genotypes</a></span><span class="op">(</span>db_path <span class="op">=</span> <span class="va">mini_db_path</span>,</span>
<span>                                      variant_ids <span class="op">=</span> <span class="va">high_variants</span><span class="op">$</span><span class="va">variant_id</span>,</span>
<span>                                      meta_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'chrom'</span>, <span class="st">'pos'</span>, <span class="st">'ref'</span>, <span class="st">'alt'</span>, <span class="st">'variant_type'</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="fu"><a href="../reference/filter_by_af.html">filter_by_af</a></span><span class="op">(</span>min_af <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
Table 3: Filtered variants from the SQLite database.
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
variant_id
</th>
<th style="text-align:left;">
chrom
</th>
<th style="text-align:right;">
pos
</th>
<th style="text-align:right;">
ref_af
</th>
<th style="text-align:right;">
alt_af
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
INDEL_Chr05_75104881
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75104881
</td>
<td style="text-align:right;">
0.9495823
</td>
<td style="text-align:right;">
0.0504177
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
INDEL_Chr05_75106156
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75106156
</td>
<td style="text-align:right;">
0.9474940
</td>
<td style="text-align:right;">
0.0525060
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
INDEL_Chr05_75106295
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75106295
</td>
<td style="text-align:right;">
0.9439141
</td>
<td style="text-align:right;">
0.0560859
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get genotype data for HIGH impact variants that passed allele filter</span></span>
<span><span class="va">geno_high_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/query_genotypes.html">query_genotypes</a></span><span class="op">(</span>db_path <span class="op">=</span> <span class="va">mini_db_path</span>,</span>
<span>                                      variant_ids <span class="op">=</span> <span class="va">geno_high_filtered</span><span class="op">$</span><span class="va">variant_id</span>,</span>
<span>                                      meta_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'chrom'</span>, <span class="st">'pos'</span>, <span class="st">'ref'</span>, <span class="st">'alt'</span>, <span class="st">'variant_type'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clean up temporary files</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>       recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="kasp-marker-design">KASP Marker Design<a class="anchor" aria-label="anchor" href="#kasp-marker-design"></a>
</h2>
<p>The <code><a href="../reference/kasp_marker_design.html">kasp_marker_design()</a></code> function enables the design of
<strong>KASP (Kompetitive Allele Specific PCR)</strong> markers from
identified putative causal variants. It supports SNP, insertion, and
deletion variants using VCF genotype data and a reference genome to
generate Intertek-compatible marker information, including upstream and
downstream polymorphic context.</p>
<p>This function automates the extraction of flanking sequences and
polymorphic variants surrounding a focal variant and generates:</p>
<ul>
<li>Intertek-ready marker submission metadata</li>
<li>DNA sequence alignment for visual inspection of marker context</li>
<li>An optional publication-ready alignment plot in PDF format</li>
</ul>
<p>The vcf file must contain the variant ID, Chromosome ID, Position,
REF and ALT alleles, as well as the genotype data for samples, as shown
in Table 1:</p>
<table class="table">
<caption>
Filtered HIGH impact variants for marker development.
</caption>
<thead><tr>
<th style="text-align:left;">
variant_id
</th>
<th style="text-align:left;">
chrom
</th>
<th style="text-align:right;">
pos
</th>
<th style="text-align:left;">
ref
</th>
<th style="text-align:left;">
alt
</th>
<th style="text-align:left;">
variant_type
</th>
<th style="text-align:left;">
IDMM
</th>
<th style="text-align:left;">
ISGC
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
INDEL_Chr05_75104881
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75104881
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
GTCGA
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
</tr>
<tr>
<td style="text-align:left;">
INDEL_Chr05_75106156
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75106156
</td>
<td style="text-align:left;">
CGTAT
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
</tr>
<tr>
<td style="text-align:left;">
INDEL_Chr05_75106295
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75106295
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
ATC
</td>
<td style="text-align:left;">
INDEL
</td>
<td style="text-align:left;">
0|0
</td>
<td style="text-align:left;">
0|0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example to design a KASP marker on a HIGH impact Deletion variant</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># (default directory for saving alignment outputs)</span></span>
<span></span>
<span><span class="co"># Path to import sorghum genome sequence for Chromosome 5</span></span>
<span><span class="va">path1</span> <span class="op">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/awkena/panGB/main/Chr05.fa.gz"</span></span>
<span></span>
<span><span class="co"># KASP marker design for variant ID: INDEL_Chr05_75106156 in Table 1</span></span>
<span><span class="va">lgs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kasp_marker_design.html">kasp_marker_design</a></span><span class="op">(</span>gt_df <span class="op">=</span> <span class="va">geno_high_filtered</span>,</span>
<span>                           variant_id_col <span class="op">=</span> <span class="st">'variant_id'</span>,</span>
<span>                           chrom_col <span class="op">=</span> <span class="st">'chrom'</span>,</span>
<span>                           pos_col <span class="op">=</span> <span class="st">'pos'</span>,</span>
<span>                           ref_al_col <span class="op">=</span> <span class="st">'ref'</span>,</span>
<span>                           alt_al_col <span class="op">=</span> <span class="st">'alt'</span>,</span>
<span>                           genome_file <span class="op">=</span> <span class="va">path1</span>,</span>
<span>                           geno_start <span class="op">=</span> <span class="fl">7</span>,</span>
<span>                           marker_ID <span class="op">=</span> <span class="st">"INDEL_Chr05_75106156"</span>,</span>
<span>                           chr <span class="op">=</span> <span class="st">"Chr05"</span>,</span>
<span>                           save_alignment <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           plot_file <span class="op">=</span> <span class="va">path</span>,</span>
<span>                           region_name <span class="op">=</span> <span class="st">"lgs1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; using Gonnet</span></span>
<span></span>
<span></span>
<span><span class="co"># View marker alignment output from temp folder</span></span>
<span><span class="va">path3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">path</span>, <span class="st">"alignment_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'open "'</span>, <span class="va">path3</span>, <span class="st">'"'</span><span class="op">)</span><span class="op">)</span> <span class="co"># Open PDF file from R</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/on.exit.html" class="external-link">on.exit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span><span class="op">)</span> <span class="co"># Clear the temp directory on exit</span></span></code></pre></div>
<p>The <code><a href="../reference/kasp_marker_design.html">kasp_marker_design()</a></code> function returns a list object
including a <code>data.frame</code> with marker design metadata:</p>
<ul>
<li>
<code>SNP_Name</code>: Variant ID</li>
<li>
<code>SNP</code>: Type of variant (SNP/INDEL)</li>
<li>
<code>Marker_Name</code>: Assigned name for the marker</li>
<li>
<code>Chromosome</code>: Chromosome name</li>
<li>
<code>Chromosome_Position</code>: Variant position</li>
<li>
<code>Sequence</code>: Intertek-style polymorphism sequence</li>
<li>
<code>ReferenceAllele</code>: Reference allele</li>
<li>
<code>AlternativeAllele</code>: Alternate allele</li>
</ul>
<p>If <code>save_alignment = TRUE</code>, a <strong>PDF plot</strong> of
sequence alignment will be saved to <code>plot_file</code>.</p>
<figure style="text-align: center;"><img src="figures/alignment.png" width="700" alt="Sequence alignment"><figcaption><em>Fig. 2.</em> Alignment of the 100 bp upstream and downstream
sequences to the reference genome used for KASP marker design.
</figcaption></figure><p>The required sequence for submission to Intertek for the designed
KASP marker is shown in Table 5.</p>
<table class="table">
<caption>
Table 5: Intertek required sequence for a KASP marker.
</caption>
<thead><tr>
<th style="text-align:left;">
SNP_Name
</th>
<th style="text-align:left;">
SNP
</th>
<th style="text-align:left;">
Marker_Name
</th>
<th style="text-align:left;">
Chromosome
</th>
<th style="text-align:right;">
Chromosome_Position
</th>
<th style="text-align:left;">
Sequence
</th>
<th style="text-align:left;">
ReferenceAllele
</th>
<th style="text-align:left;">
AlternativeAllele
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
INDEL_Chr05_75106156
</td>
<td style="text-align:left;">
Deletion
</td>
<td style="text-align:left;">
lgs1
</td>
<td style="text-align:left;">
Chr05
</td>
<td style="text-align:right;">
75106156
</td>
<td style="text-align:left;">
AACCACCGCCACTTCACCGCCGGCGCCGGGGACGACGGCTGCTGGCGCAGAGTAGCAAGTAGTAGTACTCATGCTGCTGCCTGCTGGTGTGTTTCGTATC[GTAT/-]GTAGGTGCCTATAAGAGTTTACATGCATGCATCAAAACTAAGGATCCCTCAATGTATGCATGACAGTTCAAAGAAGGCAACAAGGAAGAATTGCTTGCAT
</td>
<td style="text-align:left;">
GTAT
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
</tr></tbody>
</table>
</div>
<div class="section level2">
<h2 id="kasp-marker-validation">KASP Marker Validation<a class="anchor" aria-label="anchor" href="#kasp-marker-validation"></a>
</h2>
<p>The following example demonstrates how to use the customizable
functions in <code>panGB</code> to perform hypothesis testing of allelic
discrimination for KASP marker QC and validation.</p>
<p><code>panGB</code> offers customizable functions for KASP marker
validation through hypothesis testing. These functions allow users to
easily perform the following tasks:<br>
- Import raw or polished KASP genotyping results files (.csv) into
R.</p>
<ul>
<li><p>Process imported data and assign FAM and HEX fluorescence colors
for multiple plates.</p></li>
<li><p>Visualize marker QC using FAM and HEX fluorescence scores for
each sample.</p></li>
<li><p>Validate the effectiveness of trait-predictive or background
markers using positive controls.</p></li>
<li><p>Visualize plate design and randomization.</p></li>
</ul>
<div class="section level3">
<h3 id="reading-raw-kasp-full-results-files--csv">Reading Raw KASP Full Results Files (.csv)<a class="anchor" aria-label="anchor" href="#reading-raw-kasp-full-results-files--csv"></a>
</h3>
<p>The <code><a href="../reference/read_kasp_csv.html">read_kasp_csv()</a></code> function allows users to import raw
or polished KASP genotyping full results file (.csv) into R. The
function requires the path of the raw file and the row tags for the
different components of data in the raw file as arguments.</p>
<p>For polished files, the user must extract the <code>Data</code>
component of the full results file and save it as a csv file before
import.</p>
<p>By default, a typical unedited raw KASP data file uses the following
row tags for genotyping data: <code>Statistics</code>, <code>DNA</code>,
<code>SNPs</code>, <code>Scaling</code>, <code>Data</code>.</p>
<p>The raw file is imported as a list object in R. Thus, all components
in the imported data can be extracted using the row tag ID as shown in
the code snippet below:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import raw KASP genotyping file (.csv) using the read_kasp_csv() function</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set path to the directory where your data is located</span></span>
<span><span class="co"># path1 &lt;-  "inst/extdata/Genotyping_141.010_01.csv"</span></span>
<span><span class="va">path1</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Genotyping_141.010_01.csv"</span>,</span>
<span>                       package <span class="op">=</span> <span class="st">"panGenomeBreedr"</span>,</span>
<span>                      mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Import raw data file</span></span>
<span><span class="va">file1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_kasp_csv.html">read_kasp_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">path1</span>, </span>
<span>                       row_tags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Statistics"</span>, <span class="st">"DNA"</span>, <span class="st">"SNPs"</span>, <span class="st">"Scaling"</span>, <span class="st">"Data"</span><span class="op">)</span>,</span>
<span>                       data_type <span class="op">=</span> <span class="st">'raw'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get KASP genotyping data for plotting</span></span>
<span><span class="va">kasp_dat</span> <span class="op">&lt;-</span> <span class="va">file1</span><span class="op">$</span><span class="va">Data</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="assigning-colors-and-pch-symbols-for-kasp-cluster-plotting">Assigning colors and PCH symbols for KASP cluster plotting<a class="anchor" aria-label="anchor" href="#assigning-colors-and-pch-symbols-for-kasp-cluster-plotting"></a>
</h3>
<p>The next step after importing data is to assign FAM and HEX
fluorescence colors to samples based on their observed genotype calls.
This step is accomplished using the <code><a href="../reference/kasp_color.html">kasp_color()</a></code> function
in <code>panGB</code> as shown in the code snippet below:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign KASP fluorescence colors using the kasp_color() function</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span>
<span><span class="co"># Create a subet variable called plates: masterplate x snpid</span></span>
<span>  <span class="va">kasp_dat</span><span class="op">$</span><span class="va">plates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">kasp_dat</span><span class="op">$</span><span class="va">MasterPlate</span>, <span class="st">'_'</span>,</span>
<span>                                 <span class="va">kasp_dat</span><span class="op">$</span><span class="va">SNPID</span><span class="op">)</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kasp_color.html">kasp_color</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">kasp_dat</span>,</span>
<span>                    subset <span class="op">=</span> <span class="st">'plates'</span>,</span>
<span>                    sep <span class="op">=</span> <span class="st">':'</span>,</span>
<span>                    geno_call <span class="op">=</span> <span class="st">'Call'</span>,</span>
<span>                    uncallable <span class="op">=</span> <span class="st">'Uncallable'</span>,</span>
<span>                    unused <span class="op">=</span> <span class="st">'?'</span>,</span>
<span>                    blank <span class="op">=</span> <span class="st">'NTC'</span>,</span>
<span>                   assign_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>FAM <span class="op">=</span> <span class="st">"blue"</span>, HEX <span class="op">=</span> <span class="st">"gold"</span> , </span>
<span>                                   het <span class="op">=</span> <span class="st">"forestgreen"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/kasp_color.html">kasp_color()</a></code> function requires the KASP genotype
call file as a data frame and can do bulk processing if there are
multiple master plates. The default values for the arguments in the
<code><a href="../reference/kasp_color.html">kasp_color()</a></code> function are based on KASP annotations.</p>
<p>The <code><a href="../reference/kasp_color.html">kasp_color()</a></code> function calls the
<code><a href="../reference/kasp_pch.html">kasp_pch()</a></code> function to automatically add PCH plotting
symbols that can equally be used to group genotypic clusters on the
plot.</p>
<p>When expected genotype calls are available for positive controls in
KASP genotyping samples, we recommend the use of the PCH symbols for
grouping observed genotypes instead of FAM and HEX colors.</p>
<p>The <code><a href="../reference/kasp_color.html">kasp_color()</a></code> function expects that genotype calls
are for diploid state with alleles separated by a symbol. By default
KASP data are separated by <code>:</code> symbols.</p>
<p>The <code><a href="../reference/kasp_color.html">kasp_color()</a></code> function returns a list object with the
processed data for each master plate as the components.</p>
</div>
<div class="section level3">
<h3 id="cluster-plot">Cluster plot<a class="anchor" aria-label="anchor" href="#cluster-plot"></a>
</h3>
<p>To test the hypothesis that the designed KASP marker can accurately
discriminate between homozygotes and heterozygotes (allelic
discrimination), a cluster plot needs to be generated.</p>
<p>The <code><a href="../reference/kasp_qc_ggplot.html">kasp_qc_ggplot()</a></code> and
<code><a href="../reference/kasp_qc_ggplot2.html">kasp_qc_ggplot2()</a></code>functions in <code>panGB</code> can be
used to make the cluster plots for each plate and KASP marker as shown
below:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># KASP QC plot for Plate 05</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/kasp_qc_ggplot2.html">kasp_qc_ggplot2</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat1</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>                    pdf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                    Group_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                    scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    expand_axis <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>                    alpha <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>                    legend.pos.x <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>                    legend.pos.y <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`SE-24-1088_P01_d1_snpSB00804`</span></span></code></pre></div>
<div class="figure">
<img src="figures/plate_05_qc_1-1.png" class="r-plt" alt="Fig. 3. Cluster plot for Plate 5 using FAM and HEX colors for grouping observed genotypes." width="100%"><p class="caption">
Fig. 3. Cluster plot for Plate 5 using FAM and HEX colors for grouping
observed genotypes.
</p>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># KASP QC plot for Plate 05</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span>
<span> <span class="fu"><a href="../reference/kasp_qc_ggplot2.html">kasp_qc_ggplot2</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat1</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>                  pdf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  Group_id <span class="op">=</span> <span class="st">'Group'</span>,</span>
<span>                  Group_unknown <span class="op">=</span> <span class="st">'?'</span>,</span>
<span>                  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  pred_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Blank'</span> <span class="op">=</span> <span class="st">'black'</span>, <span class="st">'False'</span> <span class="op">=</span> <span class="st">'firebrick3'</span>,</span>
<span>                              <span class="st">'True'</span> <span class="op">=</span> <span class="st">'cornflowerblue'</span>, <span class="st">'Unverified'</span> <span class="op">=</span> <span class="st">'beige'</span><span class="op">)</span>,</span>
<span>                  expand_axis <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>                  legend.pos.x <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>                  legend.pos.y <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`SE-24-1088_P01_d1_snpSB00804`</span></span></code></pre></div>
<div class="figure">
<img src="figures/plate_05_qc_2-1.png" class="r-plt" alt="Fig. 4. Cluster plot for Plate 5 with an overlay of predictions for positive controls." width="100%"><p class="caption">
Fig. 4. Cluster plot for Plate 5 with an overlay of predictions for
positive controls.
</p>
</div>
<p>Color-blind-friendly color combinations are used to visualize
verified genotype predictions (Figure 3).</p>
<p>In Figure 4, the three genotype classes are grouped based on plot PCH
symbols using the FAM and HEX scores for observed genotype calls.</p>
<p>To simplify the verified prediction overlay for the expected
genotypes for positive controls, all possible outcomes are divided into
three categories (TRUE, FALSE, and UNVERIFIED) and color-coded to make
it easier to visualize verified predictions.</p>
<p>BLUE (color code for the TRUE category) means genotype prediction
matches the observed genotype call for the sample.</p>
<p>RED (color code for the FALSE category) means genotype prediction
does not match the observed genotype call for the sample.</p>
<p>BEIGE (color code for the UNVERIFIED category) means three things: an
expected genotype call could not be made before KASP genotyping, or an
observed genotype call could not be made to verify the prediction.</p>
<p>Users can set the <code>pdf = TRUE</code> argument to save plots as a
PDF file in a directory outside R. The <code><a href="../reference/kasp_qc_ggplot.html">kasp_qc_ggplot()</a></code> and
<code><a href="../reference/kasp_qc_ggplot2.html">kasp_qc_ggplot2()</a></code>functions can generate cluster plots for
multiple plates simultaneously.</p>
<p>To visualize predictions for positive controls to validate KASP
markers, the column name containing expected genotype calls must be
provided and passed to the function using the
<code>Group_id = 'Group'</code> argument as shown in the code snippets
above. If this information is not available, set the argument
<code>Group_id = NULL</code>.</p>
</div>
<div class="section level3">
<h3 id="summary-of-prediction-verification-in-plates">Summary of Prediction Verification in Plates<a class="anchor" aria-label="anchor" href="#summary-of-prediction-verification-in-plates"></a>
</h3>
<p>The <code><a href="../reference/pred_summary.html">pred_summary()</a></code> function produces a summary of
predicted genotypes for positive controls in each reaction plate after
verification (Table 3), as shown in the code snippet below:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get prediction summary for all plates</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span>
<span><span class="va">my_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pred_summary.html">pred_summary</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat1</span>,</span>
<span>                       snp_id <span class="op">=</span> <span class="st">'SNPID'</span>,</span>
<span>                       Group_id <span class="op">=</span> <span class="st">'Group'</span>,</span>
<span>                       Group_unknown <span class="op">=</span> <span class="st">'?'</span>,</span>
<span>                       geno_call <span class="op">=</span> <span class="st">'Call'</span>,</span>
<span>                       rate_out <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
Table 3: Summary of verified prediction status for samples in plates
</caption>
<thead><tr>
<th style="text-align:left;">
plate
</th>
<th style="text-align:left;">
snp_id
</th>
<th style="text-align:right;">
false
</th>
<th style="text-align:right;">
true
</th>
<th style="text-align:right;">
unverified
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
SE-24-1088_P01_d1_snpSB00800
</td>
<td style="text-align:left;">
snpSB00800
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
SE-24-1088_P01_d2_snpSB00800
</td>
<td style="text-align:left;">
snpSB00800
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.92
</td>
</tr>
<tr>
<td style="text-align:left;">
SE-24-1088_P01_d1_snpSB00803
</td>
<td style="text-align:left;">
snpSB00803
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.66
</td>
</tr>
<tr>
<td style="text-align:left;">
SE-24-1088_P01_d2_snpSB00803
</td>
<td style="text-align:left;">
snpSB00803
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.66
</td>
</tr>
<tr>
<td style="text-align:left;">
SE-24-1088_P01_d1_snpSB00804
</td>
<td style="text-align:left;">
snpSB00804
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.66
</td>
</tr>
<tr>
<td style="text-align:left;">
SE-24-1088_P01_d2_snpSB00804
</td>
<td style="text-align:left;">
snpSB00804
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.66
</td>
</tr>
<tr>
<td style="text-align:left;">
SE-24-1088_P01_d1_snpSB00805
</td>
<td style="text-align:left;">
snpSB00805
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.66
</td>
</tr>
<tr>
<td style="text-align:left;">
SE-24-1088_P01_d2_snpSB00805
</td>
<td style="text-align:left;">
snpSB00805
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.66
</td>
</tr>
</tbody>
</table>
<p>The output of the <code><a href="../reference/pred_summary.html">pred_summary()</a></code> function can be
visualized as bar plots using the <code><a href="../reference/pred_summary_plot.html">pred_summary_plot()</a></code>
function as shown in the code snippet below:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get prediction summary for snp:snpSB00804</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span>
<span><span class="va">my_sum</span> <span class="op">&lt;-</span> <span class="va">my_sum</span><span class="op">$</span><span class="va">summ</span></span>
<span><span class="va">my_sum</span> <span class="op">&lt;-</span> <span class="va">my_sum</span><span class="op">[</span><span class="va">my_sum</span><span class="op">$</span><span class="va">snp_id</span> <span class="op">==</span> <span class="st">'snpSB00804'</span>,<span class="op">]</span></span>
<span></span>
<span> <span class="fu"><a href="../reference/pred_summary_plot.html">pred_summary_plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">my_sum</span>,</span>
<span>                    pdf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                    pred_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'false'</span> <span class="op">=</span> <span class="st">'firebrick3'</span>, <span class="st">'true'</span> <span class="op">=</span> <span class="st">'cornflowerblue'</span>,</span>
<span>                                  <span class="st">'unverified'</span> <span class="op">=</span> <span class="st">'beige'</span><span class="op">)</span>,</span>
<span>                    alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                    text_size <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                    width <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                    height <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                    angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span>
<span><span class="co">#&gt; $snpSB00804</span></span></code></pre></div>
<div class="figure">
<img src="figures/barplot-1.png" class="r-plt" alt="Fig. 5. Match/Mismatch rate of predictions for snp: snpSB00804." width="100%"><p class="caption">
Fig. 5. Match/Mismatch rate of predictions for snp: snpSB00804.
</p>
</div>
</div>
<div class="section level3">
<h3 id="plot-plate-design">Plot Plate Design<a class="anchor" aria-label="anchor" href="#plot-plate-design"></a>
</h3>
<p>Users can visualize the observed genotype calls in a plate design
format using the <code><a href="../reference/plot_plate.html">plot_plate()</a></code> function as depicted in
Figure 5, using the code snippet below:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_plate.html">plot_plate</a></span><span class="op">(</span><span class="va">dat1</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, pdf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`SE-24-1088_P01_d1_snpSB00804`</span></span></code></pre></div>
<div class="figure">
<img src="figures/plate_05_design-1.png" class="r-plt" alt="Fig. 6. Observed genotype calls for samples in Plate 5 in a plate design format." width="100%"><p class="caption">
Fig. 6. Observed genotype calls for samples in Plate 5 in a plate design
format.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="decision-support-for-trait-introgression-and-mabc">Decision Support for Trait Introgression and MABC<a class="anchor" aria-label="anchor" href="#decision-support-for-trait-introgression-and-mabc"></a>
</h2>
<p><code>panGB</code> provides additional functionalities to test
hypotheses on the success of trait introgression pipelines and
crosses.</p>
<p>Users can easily generate heatmaps that compare the genetic
background of parents to progenies to ascertain if a target locus was
successfully introgressed or check for the hybridity of F1s. These plots
also allow users to get a visual insight into the amount of parent
germplasm recovered in progenies.</p>
<p>To produce these plots, users must have either polymorphic low or
mid-density marker data and a map file for the markers. <strong>The map
file must contain the marker IDs, their chromosome numbers and
positions</strong>.</p>
<p><code>panGB</code>can handle data from KASP, Agriplex and DArTag
service providers.</p>
<div class="section level3">
<h3 id="working-with-agriplex-mid-density-marker-data">Working with Agriplex Mid-Density Marker Data<a class="anchor" aria-label="anchor" href="#working-with-agriplex-mid-density-marker-data"></a>
</h3>
<p>Agriplex data is structurally different from KASP or DArTag data in
terms of genotype call coding and formatting. Agriplex uses
<code>' / '</code> as a separator for genotype calls for heterozygotes,
and uses single nucleotides to represent homozygous SNP calls.</p>
</div>
<div class="section level3">
<h3 id="creating-heatmaps-with-pangb">Creating Heatmaps with panGB<a class="anchor" aria-label="anchor" href="#creating-heatmaps-with-pangb"></a>
</h3>
<p>To exemplify the steps for creating heatmap, we will use a
mid-density marker data for three groups of near-isogenic lines (NILs)
and their parents (Table 4). The NILs and their parents were genotyped
using the Agriplex platform. Each NIL group was genotyped using 2421
markers.</p>
<p>The imported data frame has the markers as columns and genotyped
samples as rows. It comes with some meta data about the samples. Marker
names are informative: chromosome number and position coordinates are
embedded in the marker names
(<code>Eg. S1_778962: chr = 1, pos = 779862</code>).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Set path to the directory where your data is located</span></span>
<span><span class="va">path1</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"agriplex_dat.csv"</span>,</span>
<span>                       package <span class="op">=</span> <span class="st">"panGenomeBreedr"</span>,</span>
<span>                      mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Import raw Agriplex data file</span></span>
<span><span class="va">geno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">path1</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, colClasses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"character"</span><span class="op">)</span><span class="op">)</span> <span class="co"># genotype calls</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">geno</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, caption <span class="op">=</span> <span class="st">'Table 4: Agriplex data format'</span>, format <span class="op">=</span> <span class="st">'html'</span>, booktabs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
Table 4: Agriplex data format
</caption>
<thead><tr>
<th style="text-align:left;">
Plate.name
</th>
<th style="text-align:left;">
Well
</th>
<th style="text-align:left;">
Sample_ID
</th>
<th style="text-align:left;">
Batch
</th>
<th style="text-align:left;">
Genotype
</th>
<th style="text-align:left;">
Status
</th>
<th style="text-align:left;">
S1_778962
</th>
<th style="text-align:left;">
S1_1019896
</th>
<th style="text-align:left;">
S1_1613105
</th>
<th style="text-align:left;">
S1_1954298
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
RHODES_PLATE1
</td>
<td style="text-align:left;">
D04
</td>
<td style="text-align:left;">
NIL_1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
RTx430a
</td>
<td style="text-align:left;">
Recurrent parent
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
A
</td>
</tr>
<tr>
<td style="text-align:left;">
RHODES_PLATE1
</td>
<td style="text-align:left;">
F04
</td>
<td style="text-align:left;">
NIL_2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
RTx430b
</td>
<td style="text-align:left;">
Recurrent parent
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
A
</td>
</tr>
<tr>
<td style="text-align:left;">
RHODES_PLATE1
</td>
<td style="text-align:left;">
G04
</td>
<td style="text-align:left;">
NIL_3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
IRAT204a
</td>
<td style="text-align:left;">
Donor parent
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
A
</td>
</tr>
<tr>
<td style="text-align:left;">
RHODES_PLATE1
</td>
<td style="text-align:left;">
A05
</td>
<td style="text-align:left;">
NIL_4
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
IRAT204b
</td>
<td style="text-align:left;">
Donor Parent
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
A
</td>
</tr>
<tr>
<td style="text-align:left;">
RHODES_PLATE1
</td>
<td style="text-align:left;">
D07
</td>
<td style="text-align:left;">
NIL_5
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
RMES1+|+_1
</td>
<td style="text-align:left;">
NIL+
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
A
</td>
</tr>
<tr>
<td style="text-align:left;">
RHODES_PLATE1
</td>
<td style="text-align:left;">
F08
</td>
<td style="text-align:left;">
NIL_6
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
RMES1+|+_2
</td>
<td style="text-align:left;">
NIL+
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
G
</td>
<td style="text-align:left;">
A
</td>
</tr>
</tbody>
</table>
<p>To create a heatmap that compares the genetic background of parents
and NILs across all markers, we need to first process the raw Agriplex
data into a numeric format. The panGB package has customizable data
wrangling functions for KASP, Agriplex, and DArTag data.</p>
<p>The <code><a href="../reference/rm_mono.html">rm_mono()</a></code> function can be used to filter out all
monomorphic loci from the data.</p>
<p>Since our imported Agriplex data has informative SNP IDs, we can use
the <code><a href="../reference/parse_marker_ns.html">parse_marker_ns()</a></code> function to generate a map file
(Table 5) for the markers.<br>
The generated map file is then passed to the <code><a href="../reference/proc_kasp.html">proc_kasp()</a></code>
function to order the SNP markers according to their chromosome numbers
and positions.</p>
<p>The <code><a href="../reference/kasp_numeric.html">kasp_numeric()</a></code> function converts the output of the
<code><a href="../reference/proc_kasp.html">proc_kasp()</a></code> function into a numeric format (Table 6). The
re-coding to numeric format is done as follows:</p>
<ul>
<li>Homozygous for Parent 1 allele = 1.</li>
<li>Homozygous for Parent 2 allele = 0.</li>
<li>Heterozygous = 0.5.</li>
<li>Monomorphic loci = -1.</li>
<li>Loci with a suspected genotype error = -2.</li>
<li>Loci with at least one missing parental or any other genotype =
-5.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Parse snp ids to generate a map file</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data for stg5 NILs</span></span>
<span><span class="va">stg5</span> <span class="op">&lt;-</span> <span class="va">geno</span><span class="op">[</span><span class="va">geno</span><span class="op">$</span><span class="va">Batch</span> <span class="op">==</span> <span class="fl">3</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">stg5</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">geno</span><span class="op">$</span><span class="va">Genotype</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Remove monomorphic loci from data</span></span>
<span><span class="va">stg5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rm_mono.html">rm_mono</a></span><span class="op">(</span><span class="va">stg5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parse snp ids to generate a map file</span></span>
<span><span class="va">snps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">stg5</span><span class="op">)</span> <span class="co"># Get snp ids</span></span>
<span><span class="va">map_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse_marker_ns.html">parse_marker_ns</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">snps</span>, sep <span class="op">=</span> <span class="st">'_'</span>, prefix <span class="op">=</span> <span class="st">'S'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># order markers in map file</span></span>
<span><span class="va">map_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/order_markers.html">order_markers</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">map_file</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
Table 5: Map file for the imported Agriplex data.
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
snpid
</th>
<th style="text-align:right;">
chr
</th>
<th style="text-align:right;">
pos
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1.317
</td>
<td style="text-align:left;">
S1_402592
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
402592
</td>
</tr>
<tr>
<td style="text-align:left;">
1.1
</td>
<td style="text-align:left;">
S1_778962
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
778962
</td>
</tr>
<tr>
<td style="text-align:left;">
1.633
</td>
<td style="text-align:left;">
S1_825853
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
825853
</td>
</tr>
<tr>
<td style="text-align:left;">
1.318
</td>
<td style="text-align:left;">
S1_1218846
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1218846
</td>
</tr>
<tr>
<td style="text-align:left;">
1.2
</td>
<td style="text-align:left;">
S1_1613105
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1613105
</td>
</tr>
<tr>
<td style="text-align:left;">
1.319
</td>
<td style="text-align:left;">
S1_1727150
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1727150
</td>
</tr>
<tr>
<td style="text-align:left;">
1.3
</td>
<td style="text-align:left;">
S1_1954298
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1954298
</td>
</tr>
<tr>
<td style="text-align:left;">
1.4
</td>
<td style="text-align:left;">
S1_1985365
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1985365
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Process genotype data to re-order SNPs based on chromosome and positions</span></span>
<span><span class="va">stg5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/proc_kasp.html">proc_kasp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stg5</span>,</span>
<span>                  kasp_map <span class="op">=</span> <span class="va">map_file</span>,</span>
<span>                  map_snp_id <span class="op">=</span> <span class="st">"snpid"</span>,</span>
<span>                  sample_id <span class="op">=</span> <span class="st">"Genotype"</span>,</span>
<span>                  marker_start <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                  chr <span class="op">=</span> <span class="st">'chr'</span>,</span>
<span>                  chr_pos <span class="op">=</span> <span class="st">'pos'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to numeric format for plotting</span></span>
<span><span class="va">num_geno</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kasp_numeric.html">kasp_numeric</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stg5</span>,</span>
<span>                         rp_row <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                         dp_row <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                         sep <span class="op">=</span> <span class="st">' / '</span>,</span>
<span>                         data_type <span class="op">=</span> <span class="st">'agriplex'</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
Table 6: Agriplex data converted to a numeric format.
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
S1_402592
</th>
<th style="text-align:right;">
S1_778962
</th>
<th style="text-align:right;">
S1_825853
</th>
<th style="text-align:right;">
S1_1218846
</th>
<th style="text-align:right;">
S1_1613105
</th>
<th style="text-align:right;">
S1_1727150
</th>
<th style="text-align:right;">
S1_1954298
</th>
<th style="text-align:right;">
S1_1985365
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
BTx623a
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
BTx623b
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
BTx642a
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
BTx642b
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Stg5+|+_1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Stg5+|+_2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Stg5-|-_1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Stg5-|-_2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Stg5-|-_3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>All is now set to generate the heatmap (Figure 6) using the
<code><a href="../reference/cross_qc_ggplot.html">cross_qc_ggplot()</a></code> function, as shown in the code snippet
below:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Get prediction summary for snp:snpSB00804</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span>
<span><span class="co"># Create a heatmap that compares the parents to progenies</span></span>
<span><span class="fu"><a href="../reference/cross_qc_heatmap.html">cross_qc_heatmap</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">num_geno</span>,</span>
<span>                map_file <span class="op">=</span> <span class="va">map_file</span>,</span>
<span>                snp_ids <span class="op">=</span> <span class="st">'snpid'</span>,</span>
<span>                chr <span class="op">=</span> <span class="st">'chr'</span>,</span>
<span>                chr_pos <span class="op">=</span> <span class="st">'pos'</span>,</span>
<span>                parents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BTx623a"</span>, <span class="st">"BTx642a"</span><span class="op">)</span>,</span>
<span>                pdf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                filename <span class="op">=</span> <span class="st">'background_heatmap'</span>,</span>
<span>                legend_title <span class="op">=</span> <span class="st">'stg5_NILs'</span>,</span>
<span>                alpha <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>                text_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Batch1</span></span></code></pre></div>
<div class="figure">
<img src="figures/heatmap1-1.png" class="r-plt" alt="Fig. 6. A heatmap that compares the genetic background of parents and stg5 NIL progenies across all markers." width="100%"><p class="caption">
Fig. 6. A heatmap that compares the genetic background of parents and
stg5 NIL progenies across all markers.
</p>
</div>
<p>The <code><a href="../reference/cross_qc_ggplot.html">cross_qc_ggplot()</a></code> function is a wrapper for
functions in the <code>ggplot2</code> package.</p>
<p>Users must specify the IDs for the two parents using the
<code>parents</code> argument. In the code snippet above, the recurrent
parent is <code>BTx623</code> and the donor parent for the <em>stg5</em>
locus is <code>BTx642</code>.</p>
<p>The <code>group_sz</code> argument must be specified to plot the
heatmap in batches of progenies to avoid cluttering the plot with many
observations.</p>
<p>Users can set the <code>pdf = TRUE</code> argument to save plots as a
PDF file in a directory outside R.</p>
</div>
<div class="section level3">
<h3 id="trait-introgression-hypothesis-testing">Trait Introgression Hypothesis Testing<a class="anchor" aria-label="anchor" href="#trait-introgression-hypothesis-testing"></a>
</h3>
<p>To test the hypothesis that the <em>stg5</em> NIL development was
effective, we can use the <code><a href="../reference/cross_qc_annotate.html">cross_qc_annotate()</a></code> function to
generate a heatmap (Figure 7) with an annotation of the position of the
<em>stg5</em> locus on Chr 1, as shown below:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">###########################################################################</span></span>
<span><span class="co"># Subset data for the first 30 markers on Chr 1</span></span>
<span><span class="va">stg5_ch1</span> <span class="op">&lt;-</span> <span class="va">num_geno</span><span class="op">[</span>, <span class="va">map_file</span><span class="op">$</span><span class="va">chr</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> </span>
<span></span>
<span><span class="co"># Get the map file for subset data</span></span>
<span><span class="va">stg5_ch1_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parse_marker_ns.html">parse_marker_ns</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">stg5_ch1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Annotate a heatmap to show the stg5 locus on Chr 1</span></span>
<span><span class="co"># The locus is between positions 1e6 - 1.4 Mbp on Chr 1</span></span>
<span><span class="fu"><a href="../reference/cross_qc_heatmap.html">cross_qc_heatmap</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">stg5_ch1</span>,</span>
<span>                  map_file <span class="op">=</span> <span class="va">stg5_ch1_map</span>,</span>
<span>                  snp_ids <span class="op">=</span> <span class="st">'snpid'</span>,</span>
<span>                  chr <span class="op">=</span> <span class="st">'chr'</span>,</span>
<span>                  chr_pos <span class="op">=</span> <span class="st">'pos'</span>,</span>
<span>                  parents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BTx623a"</span>, <span class="st">"BTx642a"</span><span class="op">)</span>,</span>
<span>                  trait_pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>stg5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>chr <span class="op">=</span> <span class="fl">1</span>, start <span class="op">=</span> <span class="fl">1e6</span>, end <span class="op">=</span> <span class="fl">1.4e6</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  text_scale_fct <span class="op">=</span> <span class="fl">0.18</span>,</span>
<span>                  pdf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  legend_title <span class="op">=</span> <span class="st">'Stg5_NILs'</span>,</span>
<span>                  alpha <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>                  text_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Batch1</span></span></code></pre></div>
<div class="figure">
<img src="figures/heatmap2-1.png" class="r-plt" alt="Fig. 7. Heatmap annotation of the stg5 locus on Chr 1." width="100%"><p class="caption">
Fig. 7. Heatmap annotation of the stg5 locus on Chr 1.
</p>
</div>
<p>In the code snippet above, the numeric matrix of genotype calls and
its associated map file are required.</p>
<p>The recurrent and donor parents must be specified using the
<code>parents</code> argument.</p>
<p>The <code>snp_ids, chr, and chr_pos</code> arguments can be used to
specify the column names for marker IDs, chromosome number and positions
in the attached map file.<br>
The <code>trait_pos</code> argument was used to specify the position of
the target locus (<em>stg5</em>) on chromosome one. Users can specify
the positions of multiple target loci as components of a list object for
annotation.</p>
<p>In Figure 7, the color intensity correlates positively with the
marker density or coverage. Thus, areas with no color (white vertical
gaps) depicts gaps in the marker coverage in the data.</p>
</div>
<div class="section level3">
<h3 id="decision-support-for-mabc">Decision Support for MABC<a class="anchor" aria-label="anchor" href="#decision-support-for-mabc"></a>
</h3>
<p>Users can use the <code><a href="../reference/calc_rpp_bc.html">calc_rpp_bc()</a></code> function in
<code>panGB</code> to calculate the proportion of recurrent parent
background (RPP) fully recovered in backcross progenies.</p>
<p>It also returns the rpp value for each chromosome.</p>
<p>In the computation, partially regions are ignored, hence,
heterozygous scores are not used.</p>
<p>The output for he <code><a href="../reference/calc_rpp_bc.html">calc_rpp_bc()</a></code> function can be passed
to the <code><a href="../reference/rpp_barplot.html">rpp_barplot()</a></code> function to visualize the computed RPP
values for progenies as a bar plot. Users can specify an RPP threshold
to easily identify lines that have RPP values above or equal to the
defined RPP threshold on the bar plot.</p>
<p>We can compute and visualize the observed RPP values for the
<em>stg5</em> NILs across all polymorphic loci as shown in the code
snippet below:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Calculate weighted RPP</span></span>
<span><span class="va">rpp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rpp_bc.html">calc_rpp_bc</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">num_geno</span>,</span>
<span>                   map_file <span class="op">=</span> <span class="va">map_file</span>,</span>
<span>                   map_chr <span class="op">=</span> <span class="st">'chr'</span>,</span>
<span>                   map_pos <span class="op">=</span> <span class="st">'pos'</span>,</span>
<span>                   map_snp_ids <span class="op">=</span> <span class="st">'snpid'</span>,</span>
<span>                   rp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                   rp_num_code <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                   na_code <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>,</span>
<span>                   weighted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate bar plot for RPP values</span></span>
<span><span class="fu"><a href="../reference/rpp_barplot.html">rpp_barplot</a></span><span class="op">(</span>rpp_df <span class="op">=</span> <span class="va">rpp</span>,</span>
<span>            rpp_threshold <span class="op">=</span> <span class="fl">0.93</span>,</span>
<span>            text_size <span class="op">=</span> <span class="fl">18</span>,</span>
<span>            text_scale_fct <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>            alpha <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>            bar_width <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>            aspect_ratio <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>            pdf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures/barplot_rpp1-1.png" class="r-plt" alt="Fig. 8. Computed RPP values for the stg5 NILs." width="100%"><p class="caption">
Fig. 8. Computed RPP values for the stg5 NILs.
</p>
</div>
<table class="table">
<caption>
RPP computation across and for each chromosome.
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
sample_id
</th>
<th style="text-align:right;">
chr_1
</th>
<th style="text-align:right;">
chr_2
</th>
<th style="text-align:right;">
chr_3
</th>
<th style="text-align:right;">
chr_4
</th>
<th style="text-align:right;">
chr_5
</th>
<th style="text-align:right;">
chr_6
</th>
<th style="text-align:right;">
chr_7
</th>
<th style="text-align:right;">
chr_8
</th>
<th style="text-align:right;">
chr_9
</th>
<th style="text-align:right;">
chr_10
</th>
<th style="text-align:right;">
total_rpp
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
BTx623a
</td>
<td style="text-align:left;">
BTx623a
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
BTx623b
</td>
<td style="text-align:left;">
BTx623b
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
BTx642a
</td>
<td style="text-align:left;">
BTx642a
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
BTx642b
</td>
<td style="text-align:left;">
BTx642b
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Stg5+|+_1
</td>
<td style="text-align:left;">
Stg5+|+_1
</td>
<td style="text-align:right;">
0.880
</td>
<td style="text-align:right;">
0.997
</td>
<td style="text-align:right;">
0.931
</td>
<td style="text-align:right;">
0.995
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.949
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.840
</td>
<td style="text-align:right;">
0.959
</td>
</tr>
<tr>
<td style="text-align:left;">
Stg5+|+_2
</td>
<td style="text-align:left;">
Stg5+|+_2
</td>
<td style="text-align:right;">
0.924
</td>
<td style="text-align:right;">
0.997
</td>
<td style="text-align:right;">
0.939
</td>
<td style="text-align:right;">
0.987
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.949
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.796
</td>
<td style="text-align:right;">
0.959
</td>
</tr>
<tr>
<td style="text-align:left;">
Stg5-|-_1
</td>
<td style="text-align:left;">
Stg5-|-_1
</td>
<td style="text-align:right;">
0.982
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.455
</td>
<td style="text-align:right;">
0.984
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.759
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.949
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.796
</td>
<td style="text-align:right;">
0.892
</td>
</tr>
<tr>
<td style="text-align:left;">
Stg5-|-_2
</td>
<td style="text-align:left;">
Stg5-|-_2
</td>
<td style="text-align:right;">
0.991
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.286
</td>
<td style="text-align:right;">
0.987
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.995
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.949
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.845
</td>
<td style="text-align:right;">
0.905
</td>
</tr>
<tr>
<td style="text-align:left;">
Stg5-|-_3
</td>
<td style="text-align:left;">
Stg5-|-_3
</td>
<td style="text-align:right;">
0.991
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.278
</td>
<td style="text-align:right;">
0.987
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.931
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.949
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.845
</td>
<td style="text-align:right;">
0.898
</td>
</tr>
</tbody>
</table>
<p>The <code><a href="../reference/calc_rpp_bc.html">calc_rpp_bc()</a></code> function in <code>panGB</code>
provides two algorithms for computing the observed RPP values: weighted
and unweighted RPP values. We recommend the use of the weighted
algorithm to account for differences in the marker coverage across the
genome.</p>
<p>The algorithm for the weighted RPP values is explained below.</p>
<div class="section level4">
<h4 id="weighted-rpp-computation-in-pangb">Weighted RPP Computation in panGB<a class="anchor" aria-label="anchor" href="#weighted-rpp-computation-in-pangb"></a>
</h4>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>i</mi></msub><annotation encoding="application/x-tex">w_i</annotation></semantics></math>
represent the weight for marker
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
based on the relative distances to its adjacent markers.</p>
<p>For a set of markers with positions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>,</mo><msub><mi>p</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>p</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">p_1, p_2, \ldots, p_n</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><msub><mi>p</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i = p_{i+1} - p_i</annotation></semantics></math>
represents the distance between adjacent markers, the weights can be
calculated as follows:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>For the first marker</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i = 1</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><mfrac><msub><mi>d</mi><mn>1</mn></msub><mrow><mn>2</mn><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>d</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">w_1 = \frac{d_1}{2 \sum_{i=1}^{n-1} d_i}</annotation></semantics></math></p>
</li>
<li>
<p><strong>For a middle marker</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>&lt;</mo><mi>i</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1 &lt; i &lt; n</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>d</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>d</mi><mi>i</mi></msub></mrow><mrow><mn>2</mn><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>d</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">w_i = \frac{d_{i-1} + d_i}{2 \sum_{i=1}^{n-1} d_i}</annotation></semantics></math></p>
</li>
<li>
<p><strong>For the last marker</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">i = n</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>n</mi></msub><mo>=</mo><mfrac><msub><mi>d</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mrow><mn>2</mn><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>d</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">w_n = \frac{d_{n-1}}{2 \sum_{i=1}^{n-1} d_i}</annotation></semantics></math></p>
</li>
</ol>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>i</mi></msub><annotation encoding="application/x-tex">d_i</annotation></semantics></math>
is the distance between marker
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and marker
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i+1</annotation></semantics></math>,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">sum_{i=1}^{n-1} d_i</annotation></semantics></math>
is the total distance across all segments, used for normalization.</li>
</ul>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>P</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">RPP</annotation></semantics></math>
represent the Recurrent Parent Proportion based on relative distance
weighting. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>i</mi></msub><annotation encoding="application/x-tex">w_i</annotation></semantics></math>
is the weight for each marker
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>i</mi></msub><annotation encoding="application/x-tex">m_i</annotation></semantics></math>
represents whether marker
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
matches the recurrent parent
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m_i = 1</annotation></semantics></math>
if it matches,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">m_i = 0</annotation></semantics></math>
otherwise), then the weighted RPP is calculated as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>P</mi><msub><mi>P</mi><mrow><mi>w</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>m</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">RPP_{weighted} = \sum_{i=1}^n w_i\cdot m_i</annotation></semantics></math></p>
<p>The unweighted RPP is calculated without the use of the weights as
follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>P</mi><msub><mi>P</mi><mrow><mi>u</mi><mi>n</mi><mi>w</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow></msub><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>m</mi><mi>i</mi></msub></mrow><mi>n</mi></mfrac></mrow><annotation encoding="application/x-tex">RPP_{unweighted} = \frac{\sum_{i=1}^n m_i} n</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>i</mi></msub><annotation encoding="application/x-tex">w_i</annotation></semantics></math>
is the weight of marker
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
calculated based on the relative distance it covers,</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>i</mi></msub><annotation encoding="application/x-tex">m_i</annotation></semantics></math>
is the match indicator for marker
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
(1 if matching the recurrent parent, 0 otherwise),</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is the total number of markers.</li>
</ul>
<p>This formula provides the sum of the weighted contributions from each
marker, representing the proportion of the recurrent parent genome in
the individual.</p>
</div>
</div>
<div class="section level3">
<h3 id="decision-support-for-foreground-selection">Decision Support for Foreground Selection<a class="anchor" aria-label="anchor" href="#decision-support-for-foreground-selection"></a>
</h3>
<p>The <code><a href="../reference/foreground_select.html">foreground_select()</a></code> and <code><a href="../reference/find_lines.html">find_lines()</a></code>
functions are designed to help breeders identify lines that carry
<strong>favorable alleles at target loci</strong> using trait-predictive
markers. This process supports <strong>foreground selection</strong> in
marker-assisted selection pipelines.</p>
<div class="section level4">
<h4 id="generate-a-binary-matrix-foreground_select-function">Generate a Binary Matrix: <code>foreground_select()</code>
function<a class="anchor" aria-label="anchor" href="#generate-a-binary-matrix-foreground_select-function"></a>
</h4>
<p>The <code><a href="../reference/foreground_select.html">foreground_select()</a></code> function score Lines for
presence of favorable alleles by converting raw marker genotype data
into a binary matrix (1 = favorable allele present, 0 = absent) based on
a set of trait-predictive markers. The <code><a href="../reference/foreground_select.html">foreground_select()</a></code>
function is shown in the code snippet below:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Marker genotype data</span></span>
<span><span class="va">geno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>SNP1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A:A"</span>, <span class="st">"A:G"</span>, <span class="st">"G:G"</span>, <span class="st">"A:A"</span><span class="op">)</span>,</span>
<span>                   SNP2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C:C"</span>, <span class="st">"C:T"</span>, <span class="st">"T:T"</span>, <span class="st">"C:T"</span><span class="op">)</span>,</span>
<span>                   SNP3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G:G"</span>, <span class="st">"G:G"</span>, <span class="st">"A:G"</span>, <span class="st">"A:A"</span><span class="op">)</span>,</span>
<span>                   row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Line1"</span>, <span class="st">"Line2"</span>, <span class="st">"Line3"</span>, <span class="st">"Line4"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Trait-predictive marker metadata</span></span>
<span><span class="va">marker_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>qtl_markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"SNP"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>                           locus_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'loc'</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>                          fav_alleles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span><span class="op">)</span>,</span>
<span>                         </span>
<span>                          alt_alleles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="st">"T"</span>, <span class="st">"A"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert raw genotypes to binary (foreground profile)</span></span>
<span><span class="va">foreground_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/foreground_select.html">foreground_select</a></span><span class="op">(</span>geno_data <span class="op">=</span> <span class="va">geno</span>,</span>
<span>                                       fore_marker_info <span class="op">=</span> <span class="va">marker_info</span>,</span>
<span>                                       fore_marker_col <span class="op">=</span> <span class="st">"qtl_markers"</span>,</span>
<span>                                       fav_allele_col <span class="op">=</span> <span class="st">"fav_alleles"</span>,</span>
<span>                                       alt_allele_col <span class="op">=</span> <span class="st">"alt_alleles"</span>,</span>
<span>                                       select_type <span class="op">=</span> <span class="st">"homo"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
Binary matrix of presence or absence of favorable alleles.
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
SNP1
</th>
<th style="text-align:right;">
SNP2
</th>
<th style="text-align:right;">
SNP3
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Line1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Line2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Line3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Line4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>The <code><a href="../reference/foreground_select.html">foreground_select()</a></code> function has the following input
parameters:</p>
<table class="table">
<colgroup>
<col width="43%">
<col width="29%">
<col width="27%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>geno_data</code></td>
<td><code>data.frame</code></td>
<td>Marker genotype data (lines x markers), e.g., <code>"A:A"</code>,
<code>"A:G"</code>
</td>
</tr>
<tr class="even">
<td><code>fore_marker_info</code></td>
<td><code>data.frame</code></td>
<td>Metadata describing trait-predictive markers, including marker
names, favorable alleles, and alternate alleles</td>
</tr>
<tr class="odd">
<td><code>fore_marker_col</code></td>
<td><code>character</code></td>
<td>Column name in <code>fore_marker_info</code> for marker names</td>
</tr>
<tr class="even">
<td><code>fav_allele_col</code></td>
<td><code>character</code></td>
<td>Column name for favorable allele</td>
</tr>
<tr class="odd">
<td><code>alt_allele_col</code></td>
<td><code>character</code></td>
<td>Column name for alternate allele</td>
</tr>
<tr class="even">
<td><code>select_type</code></td>
<td><code>character</code></td>
<td>Genotype class to select: <code>"homo"</code>,
<code>"hetero"</code>, or <code>"both"</code>
</td>
</tr>
<tr class="odd">
<td><code>sep</code></td>
<td><code>character</code></td>
<td>Separator used in genotype calls (e.g., <code>":"</code>)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="visualize-the-binary-data-with-upset-plot">Visualize the Binary Data with UpSet Plot<a class="anchor" aria-label="anchor" href="#visualize-the-binary-data-with-upset-plot"></a>
</h4>
<p>Generate an UpSet plot using the <code>UpSetR</code> package to
explore the co-occurrence of favorable alleles across lines. The UpSet
plot allows users to quickly determine:</p>
<ul>
<li><p>Whether any line carries favorable alleles at all target
loci.</p></li>
<li><p>How favorable alleles are distributed across lines.</p></li>
<li><p>Which loci are rarely combined.</p></li>
</ul>
<p><strong>How to Interpret the UpSet Plot:</strong></p>
<ul>
<li><p><strong>Top bar plot:</strong> shows the number of lines for each
unique combination (intersection) of target loci with favorable
alleles.</p></li>
<li><p><strong>Bottom matrix of dots and lines:</strong> indicates which
loci are involved in each combination.</p></li>
<li><p><strong>Left bar plot:</strong> shows how many lines have the
favorable allele for each individual target locus.</p></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make an Upset plot and overlay with trait loci names</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sets <span class="op">=</span> <span class="va">marker_info</span><span class="op">$</span><span class="va">qtl_markers</span>,</span>
<span>                      locus <span class="op">=</span> <span class="va">marker_info</span><span class="op">$</span><span class="va">locus_name</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">foreground_matrix</span><span class="op">)</span> <span class="co"># Number of markers</span></span>
<span></span>
<span><span class="fu">UpSetR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/UpSetR/man/upset.html" class="external-link">upset</a></span><span class="op">(</span><span class="va">foreground_matrix</span>,</span>
<span>              nsets <span class="op">=</span> <span class="va">nl</span>,</span>
<span>              mainbar.y.label <span class="op">=</span> <span class="st">"Locus Intersection Size"</span>,</span>
<span>              sets.x.label <span class="op">=</span> <span class="st">"Locus Size"</span>,</span>
<span>              text.scale <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>              set.metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">metadata</span>,</span>
<span>                          plots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">'text'</span>, </span>
<span>                                            assign <span class="op">=</span> <span class="fl">8</span>,</span>
<span>                                            column <span class="op">=</span> <span class="st">'locus'</span>,</span>
<span>                                            colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'firebrick2'</span>, <span class="va">nl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `aes_string()` was deprecated in ggplot2 3.0.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use tidy evaluation idioms with `aes()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> See also `vignette("ggplot2-in-packages")` for more information.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">UpSetR</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue to the authors.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">UpSetR</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue to the authors.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use the `linewidth` argument instead.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">UpSetR</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue to the authors.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre></div>
<div class="figure">
<img src="figures/upset_plot1-1.png" class="r-plt" alt="Fig. 9. Visualizing the co-occurrence of favorable alleles across lines." width="100%"><p class="caption">
Fig. 9. Visualizing the co-occurrence of favorable alleles across lines.
</p>
</div>
</div>
<div class="section level4">
<h4 id="query-lines-by-intersection-category-find_lines-function">Query Lines by Intersection Category: <code>find_lines()</code>
function<a class="anchor" aria-label="anchor" href="#query-lines-by-intersection-category-find_lines-function"></a>
</h4>
<p>The <code><a href="../reference/find_lines.html">find_lines()</a></code> function identifies lines based on
target loci profile by filtering the binary output of
<code><a href="../reference/foreground_select.html">foreground_select()</a></code> to return line names that match a
desired allele presence/absence profile across loci. Using the binary
matrix, users can extract line IDs corresponding to any intersection
(i.e., specific combinations of favorable alleles revealed by the UpSet
plot).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find lines with favorable alleles at all target loci</span></span>
<span><span class="va">selected_lines</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_lines.html">find_lines</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">foreground_matrix</span>,</span>
<span>                             present <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'SNP1'</span>, <span class="st">'SNP2'</span>, <span class="st">'SNP3'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">selected_lines</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Line1"</span></span></code></pre></div>
<p>The <code><a href="../reference/find_lines.html">find_lines()</a></code> function has the following input
parameters:</p>
<table class="table">
<thead><tr class="header">
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>mat</code></td>
<td><code>data.frame</code></td>
<td>Binary matrix.</td>
</tr>
<tr class="even">
<td><code>present</code></td>
<td><code>character</code></td>
<td>Markers that must be 1.</td>
</tr>
<tr class="odd">
<td><code>absent</code></td>
<td><code>character</code></td>
<td>Markers that must be 0.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<p>If the package does not run as expected, check the following:</p>
<ul>
<li><p>Was the package properly installed?</p></li>
<li><p>Do you have the required dependencies installed?</p></li>
<li><p>Were any warnings or error messages returned during package
installation?</p></li>
<li><p>Are all packages up to date before installing panGB?</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="authors-and-contributors">Authors and contributors<a class="anchor" aria-label="anchor" href="#authors-and-contributors"></a>
</h2>
<ul>
<li><p><a href="https://www.github.com/awkena" class="external-link">Alexander Wireko
Kena</a></p></li>
<li><p><a href="https://github.com/Israel-Tetteh" class="external-link">Israel Tawiah
Tetteh</a></p></li>
<li><p><a href="https://www.morrislab.org/people/clara-cruet-burgos" class="external-link">Cruet
Burgos</a></p></li>
<li><p><a href="https://www.biofortificationlab.org/people/linly-banda" class="external-link">Linly
Banda</a></p></li>
<li><p><a href="https://sites.google.com/site/morrislaboratory/people/jacques-faye" class="external-link">Jacques
Faye</a></p></li>
<li><p><a href="https://www.morrislab.org/people/fanna-maina" class="external-link">Fanna
Maina</a></p></li>
<li><p><a href="https://www.agronomy.k-state.edu/about/people/faculty/felderhoff-terry/" class="external-link">Terry
Felderhoff</a></p></li>
<li><p><a href="https://www.morrislab.org/people/geoff-morris" class="external-link">Geoffrey
Preston Morris</a></p></li>
</ul>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p><a href="https://choosealicense.com/licenses/gpl-3.0/" class="external-link">GNU
GPLv3</a></p>
</div>
<div class="section level2">
<h2 id="support-and-feedback">Support and Feedback<a class="anchor" aria-label="anchor" href="#support-and-feedback"></a>
</h2>
<p>For support and submission of feedback, email the maintainer
<strong>Alexander Kena, PhD</strong> at <a href="mailto:alex.kena24@gmail.com" class="email">alex.kena24@gmail.com</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexander Wireko Kena, Israel Tawiah Tetteh, Clara Cruet Burgos, Geoffrey Preston Morris.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
