<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Process reshaped KASP genotype data for heatmap plotting — proc_kasp • panGenomeBreedr</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Process reshaped KASP genotype data for heatmap plotting — proc_kasp"><meta name="description" content="Process reshaped KASP genotype data for heatmap plotting"><meta property="og:description" content="Process reshaped KASP genotype data for heatmap plotting"><meta property="og:image" content="https://awkena.github.io/panGenomeBreedr/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">panGenomeBreedr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/awkena/panGenomeBreedr" aria-label="GitHub repository"><span class="fa fab fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Process reshaped KASP genotype data for heatmap plotting</h1>
      <small class="dont-index">Source: <a href="https://github.com/awkena/panGenomeBreedr/blob/HEAD/R/kasp_validation.R" class="external-link"><code>R/kasp_validation.R</code></a></small>
      <div class="d-none name"><code>proc_kasp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Process reshaped KASP genotype data for heatmap plotting</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">proc_kasp</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="st">"SubjectID"</span>,</span>
<span>  marker_start <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="va">kasp_map</span>,</span>
<span>  <span class="va">map_snp_id</span>,</span>
<span>  chr <span class="op">=</span> <span class="st">"chr"</span>,</span>
<span>  chr_pos <span class="op">=</span> <span class="st">"pos"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A data frame of genotype calls.</p></dd>


<dt id="arg-sample-id">sample_id<a class="anchor" aria-label="anchor" href="#arg-sample-id"></a></dt>
<dd><p>A string representing the column name of unique sample IDs.</p></dd>


<dt id="arg-marker-start">marker_start<a class="anchor" aria-label="anchor" href="#arg-marker-start"></a></dt>
<dd><p>An integer indicating the column index for the start of SNP calls.</p></dd>


<dt id="arg-kasp-map">kasp_map<a class="anchor" aria-label="anchor" href="#arg-kasp-map"></a></dt>
<dd><p>A data frame consisting of marker chromosome number and positions.</p></dd>


<dt id="arg-map-snp-id">map_snp_id<a class="anchor" aria-label="anchor" href="#arg-map-snp-id"></a></dt>
<dd><p>A character value indicating the column name for SNP IDs
in <code>kasp_map</code>.</p></dd>


<dt id="arg-chr">chr<a class="anchor" aria-label="anchor" href="#arg-chr"></a></dt>
<dd><p>A character value for the column name for the chromosome number in
<code>kasp_map</code>.</p></dd>


<dt id="arg-chr-pos">chr_pos<a class="anchor" aria-label="anchor" href="#arg-chr-pos"></a></dt>
<dd><p>A character value for the column name for the chromosome positions
in <code>kasp_map</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame object of re-ordered SNPs based on chromosome numbers
and positions.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is experimental and should only be used with reshaped KASP data.
The data processing involves the following steps:
1. Transposing the data
2. Matching marker names in KASP map file with names in KASP genotype file
3. Column bind matched map for markers to the transposed data
4. Sort data in ascending order of chromosome numbers
5. Split data by chromosomes
6. Sort data in ascending order of physical positions per chromosome
7. Row bind sorted data together
8. Re-transpose data to make markers columns and samples as rows for plotting.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># example code</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://awkena.github.io/panGenomeBreedr">panGenomeBreedr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu">panGenomeBreedr</span><span class="fu">::</span><span class="va"><a href="beta_carotene.html">beta_carotene</a></span></span></span>
<span class="r-in"><span><span class="co"># Reshape KASP data for each master plate for the beta_carotene data</span></span></span>
<span class="r-in"><span><span class="va">plate_wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="kasp_reshape_wide.html">kasp_reshape_wide</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dat1</span>,</span></span>
<span class="r-in"><span>                                subset <span class="op">=</span> <span class="st">'MasterPlate'</span>,</span></span>
<span class="r-in"><span>                                snp_id <span class="op">=</span> <span class="st">'SNPID'</span>,</span></span>
<span class="r-in"><span>                                geno_call <span class="op">=</span> <span class="st">'Call'</span>,</span></span>
<span class="r-in"><span>                                idvar <span class="op">=</span> <span class="st">"SubjectID"</span>,</span></span>
<span class="r-in"><span>                                blank <span class="op">=</span> <span class="st">'NTC'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get Master Plate 1</span></span></span>
<span class="r-in"><span><span class="va">plate1</span> <span class="op">&lt;-</span> <span class="va">plate_wide</span><span class="op">$</span><span class="va">`SE-24-1088_P01_d1`</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a map for the beta_carotene KASP data</span></span></span>
<span class="r-in"><span><span class="va">kasp_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>SNPID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">beta_carotene</span><span class="op">$</span><span class="va">SNPID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       SNPID_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'snpSB'</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="st">'|'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">800</span>, <span class="fl">803</span>, <span class="fl">804</span>, <span class="fl">805</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       chr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">800</span>, <span class="fl">803</span>, <span class="fl">804</span>, <span class="fl">805</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Process Plate1 to re-order SNPs based on chrom. and position</span></span></span>
<span class="r-in"><span><span class="va">proc_plate1</span> <span class="op">&lt;-</span> <span class="fu">proc_kasp</span><span class="op">(</span>x <span class="op">=</span> <span class="va">plate1</span>,</span></span>
<span class="r-in"><span>                         kasp_map <span class="op">=</span> <span class="va">kasp_map</span>,</span></span>
<span class="r-in"><span>                         map_snp_id <span class="op">=</span> <span class="st">"SNPID"</span>,</span></span>
<span class="r-in"><span>                         sample_id <span class="op">=</span> <span class="st">"SubjectID"</span>,</span></span>
<span class="r-in"><span>                         marker_start <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                         chr <span class="op">=</span> <span class="st">'chr'</span>,</span></span>
<span class="r-in"><span>                         chr_pos <span class="op">=</span> <span class="st">'pos'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexander Wireko Kena, Israel Tawiah Tetteh, Clara Cruet Burgos, Geoffrey Preston Morris.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

